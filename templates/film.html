{% extends "base.html" %}

{% block title %}{{ film.name }}{% endblock %}

{% block styles %}
<style>
    .film-container {
        display: flex;
        gap: 30px;
        padding: 30px;
        max-width: 1200px;
        margin: 0 auto;
    }
    .film-poster {
        flex: 1;
        max-width: 500px;
    }
    .film-poster img {
        width: 100%;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    .film-details {
        flex: 1;
    }
    .film-title {
        font-size: 2em;
        margin-bottom: 20px;
        color: #4CAF50;
    }
    .film-meta {
        margin-bottom: 20px;
        color: #aaa;
    }
    .film-description {
        margin-bottom: 30px;
        line-height: 1.6;
    }
    .film-section {
        margin-bottom: 20px;
    }
    .film-section h3 {
        color: #4CAF50;
        margin-bottom: 10px;
    }
    .country-map {
        width: 100%;
        height: 300px;
        object-fit: cover;
        border-radius: 10px;
        margin-top: 10px;
    }
    .film-actions {
        display: flex;
        gap: 15px;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #333;
    }
    .film-actions .btn {
        padding: 10px 20px;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
        text-decoration: none;
        display: inline-block;
        text-align: center;
    }
    .btn-back {
        background: #4CAF50;
        color: white;
    }
    .btn-watched {
        background: #2196F3;
        color: white;
    }
    .btn-favorite {
        background: {{ '#ff5252' if is_favorite else '#607d8b' }};
        color: white;
    }
    .btn i {
        margin-right: 8px;
    }
</style>
{% endblock %}

{% block content %}
<div class="film-container">
    <div class="film-poster">
        <img src="{{ film.picture }}" alt="{{ film.name }}">
    </div>
    <div class="film-details">
        <h1 class="film-title">{{ film.name }}</h1>

        <div class="film-meta">
            <span>{{ film.year }} год</span> |
            <span>{{ film.genre }}</span> |
            <span>★ {{ film.rating }}/10</span>
        </div>

        <div class="film-description" style="min-height: {{ desc_height }};">
            <p>{{ film.description }}</p>
        </div>

        <div class="film-section">
            <h3>Актеры</h3>
            <p>{{ film.actors }}</p>
        </div>

        <div class="film-section">
            <h3>Страна производства</h3>
            <p>{{ film.country }}</p>
            {% if map_image %}
            <img src="{{ url_for('static', filename='uploads/' + map_image) }}"
                 alt="Карта {{ film.country }}" class="country-map">
            {% endif %}
        </div>

        <!-- Блок с кнопками -->
        <div class="film-actions">
            <a href="{{ url_for('index') }}" class="btn btn-back">
                <i class="fas fa-arrow-left"></i> Назад к фильмам
            </a>

            {% if not is_watched %}
            <form method="POST" action="{{ url_for('add_watched', movie_id=film.id) }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-watched">
                    <i class="fas fa-eye"></i> Добавить в просмотренные
                </button>
            </form>
            {% else %}
            <span class="btn btn-watched" style="background: #4CAF50;">
                <i class="fas fa-check"></i> Просмотрено
            </span>
            {% endif %}

            <form method="POST" action="{{ url_for('toggle_favorite', movie_id=film.id) }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-favorite">
                    {% if is_favorite %}
                        <i class="fas fa-heart"></i> Удалить из избранного
                    {% else %}
                        <i class="far fa-heart"></i> В избранное
                    {% endif %}
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- Только Font Awesome для иконок -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
{% endblock %}